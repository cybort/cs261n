\documentclass{article}  
\usepackage{url}

\setlength{\parskip}{\baselineskip}

\begin{document}

% VPN arms race We seek to build a system that remains difficult to block even
% after it has many users.

\section{Related work}

% In response to Internet censorship, many research papers and pragmatic systems
% such Freegate, Psiphon, and Lantern have explored the design space of censorship
% circumvention. All these schemes are based on a simple idea: deploy a set of
% proxies outside the censor's domain, and let the user connect to one of them
% which can pass data on to the true destination for the user.

Broadly speaking, there are two main challenges to proxy-based circumvention:
blocking by content and blocking by endpoint.
Blocking by content means that the censor inspect packet or flow payloads,
looking, for example, for forbidden protocols or keywords.
Content-based blocking is countered by obfuscation:
making circumvention traffic difficult to distinguish
from traffic the censor wishes to allow.
Blocking by endpoint means that the censor forbids all communication with certain
network addresses, whatever the content of the communication.
The challenge of endpoint blocking is met by making it difficult for the censor to learn proxy addresses;
by making it difficult to scan for proxies;
by having sufficiently many proxies;
or by colocating proxies with high-value services, to block which would incur collateral damage.
Effective proxy-based circumvention requires that both these challenges be addressed.

Traffic obfuscation has been approached in many different ways,
which may be classified into two general techniques.
The first technique is to look unlike
anything forbidden by the censor; that is, fail to match a blacklist. The second is
to resemble a protocol that is explicitly allowed by the censor; that is, match a whitelist.
Falling into the first category are ``look-like-nothing'' transports whose
payloads are indistinguishable from a uniformly random byte stream.
The classic example of a look-like-nothing
protocol is obfsproxy~\cite{obfsproxy}, long the go-to obfuscated
transport used by Tor. ScrambleSuit~\cite{scramblesuit} is like obfsproxy in the
content of its payloads, but it takes additional steps to obscure its traffic signature
(packet lengths and timing), and is designed to resist active scanning for proxies
(the proxy server remains silent until the client proves knowledge of a shared
secret).

The other category of obfuscation contains transports that take the steganographic approach: look like
something the censor doesn't block. StegoTorus~\cite{stegotorus}
encodes traffic to look like a cover protocol, such as unencrypted HTTP,
using special-purpose encoders.
Code Talker
Tunnel (formerly called SkypeMorph)~\cite{skypemorph} mimics a Skype video call.
FreeWave~\cite{freewave} encodes a digital stream into an acoustic signal
and sends it over VoIP to a proxy which decodes and forwards it to the destination.
Format-transforming encryption~\cite{fte} encodes data into strings that match a given regular expression,
in order to match a firewall's whitelist or avoid matching a blacklist.

Houmansadr et~al.~\cite{parrot} evaluate ``parrot'' systems that imitate a particular implementation of a protocol
and conclude that unobservability by imitation is a ``fundamentally
flawed approach.''
To fully mimic a complex and sometimes proprietary protocol like Skype
is difficult in that the system must imitate not only the protocol's normal operation, but also its reaction to errors,
its typical traffic patterns, and quirks of common implementations.
Geddes et~al.~\cite{acks}
demonstrate that even non-parrot systems may be vulnerable to
attacks that disrupt covert communication while having little effect
on legitimate traffic. Their examination is specific to VoIP protocols,
where packet loss and duplication are acceptable. The censor may
deliberately drop or inject ACKs in order to disrupt the covert channel, without causing
much collateral damage.


The other grand challenge of proxy-based circumvention is endpoint blocking,
against which there have been a few approaches proposed.
Tor has long faced the problem of its entry relays being blocked. The list of
relays is public, so it easy to block all of them by IP address. Tor
bridges~\cite{tor-blocking} are relays that are not universally known, intended
to serve as entry points for censored users. A database of bridges (BridgeDB) seeks to
provide a few secret bridges to anyone who asks, while at the same time making it
difficult to learn the entire list.
The database is accessible over HTTPS and email.
The HTTPS interface requires solving a captcha,
and the email interface responds only to addresses from certain providers, like Gmail,
that have defenses against bulk account creation.
BridgeDB has the feature that repeated queries from the same address
(IP subnet or email address) will receive the same small set of bridges.
Its resistance to enumeration therefore depends both on
having a large number of potential bridges,
and on the censor not being able to control large numbers of IP and email addresses.
BridgeDB is capable of distributing
the addresses of obfsproxy and ScrambleSuit bridges.
The combination
of careful bridge address disbursement and obfuscated protocols
gives Tor's system a realistic claim to addressing both challenges of proxy-based circumvention.
Address distribution appears to be the weaker side of the defense,
as evidenced by real-world censors' apparent preference for
blocking bridge addresses over real-time deobfuscation~\cite{foci12-winter}.

Flash proxy~\cite{flashproxy} attempts to address endpoint blocking by
conscripting web users as temporary proxies. Proxies last only as long as a web
user stays on a page, so the pool of proxies is constantly changing and
difficult to block.
Flash proxy's approach to unblockability is in a sense
the opposite of ours: where flash proxy uses cheap, disposable, individually blockable proxies,
we use just one high-value proxy, which shares its fate with network
infrastructure that is expensive to block.
There exists a prototype transport that attempts to get both
obfuscation and address unblockability by combining flash proxy
with obfsproxy~\cite{obfs-flash}, however it is limited because it is not
possible to obfuscate flash proxy's outermost WebSocket layer.

% Lantern
% Psiphon

A technique known as OSS~\cite{oss} (for
``online scanning service'') resembles ours in certain ways. OSS bounces data
through third-party web services that are capable of making HTTP requests.
Even though such services can fetch a web page, they do not in general
preserve the contents of the page when it is returned to the requestor.
(A translation service, for example,
returns the page after translating it to another language.)
For this reason, OSS does not rely on being able to send downstream data in HTTP response bodies,
but rather requires the server to make a symmetric reflected HTTP request back to the client.
The main ways in which this work differs is that we are effectively using an OSS that we fully control:
we can ensure that reflected HTTP traffic is unmodified;
and we make the OSS hard to block by hosting it on an important network resource.

Decoy routing is
a recently proposed anti-blocking approach. Telex~\cite{telex}
asks friendly ISPs to deploy special software on routers between censored users and
popular, uncensored Internet destinations.
Circumvention traffic is marked with a special ``tag'' that is distinguishable from a random string only
by Telex routers (not by the censor).
On receiving such a tagged communication, the Telex router shunts it away from its apparent destination
and toward the censored destination requested by the client.
CensorSpoofer~\cite{censorspoofer}
decouples the upstream and downstream channels.
Upstream data are carried over a low-bandwidth covert channel such as email.
The CensorSpoofer proxy protects its address by
spoofing the source IP address of all downstream data sent back to the client.
In addition to spoofing, the CensorSpoofer authors propose to obfuscate the downstream with a SIP-based steganographic channel.
A recent study~\cite{nodirectionhome} on AS
topology suggests that defeating decoy routing is likely to be expensive for the
censors, if the decoy routers are strategically deployed. Despite that decoy
routing is a sound technical approach, it is still questionable whether ISPs are
willing to act against state-level censors. However, the takeaway is that the
censors are unwilling to completely block day-to-day Internet access, which we
can take advantage of.
Of the decoy routing systems, Telex is the most similar to our work.
Both systems use a piece of network infrastructure as a decoy to redirect certain flows
(for Telex it is an ISP router; for us it is the Google frontend server),
and both tag flows in a way that is visible only to the decoy router
(for Telex a tag is a hash embedded in the TLS client randomness; for us it is the HTTP Host header).

% Routing around decoys
% Cirripede

Winter and Lindskog~\cite{foci12-winter} investigated how China's Great Firewall blocks Tor.
They confirmed an earlier discovery of Wilde~\cite{wilde} that the firewall identifies Tor relays using more than passive monitoring:
it actively probes destination addresses to see if they speak the Tor protocol, and if so,
blocks them for the future.
(At the time, the firewall identified potential Tor connections for future probing by looking for a distinctive
list of TLS ciphersuites---a failure of obfuscation.) %\cite{bug4744}
The discovery of Chinese active probing was the motivation for probing resistance in ScrambleSuit
and in our work.

GoAgent~\cite{goagent} is a direct inspiration for our system in its use of App
Engine and Host header--based domain fronting. GoAgent requires users to upload
a personal copy of the server code to App Engine, and works only with HTTP and HTTPS,
not other TCP-based protocols.
According to a May 2013 survey~\cite{collateral-freedom},
GoAgent was the circumvention tool most used in
China, with 35\% of survey respondents having used it in the previous month.
This figure is higher than that of paid~(29\%) and free VPNs~(18\%), and far
above that of other special-purpose tools like Tor~(2.9\%) and Psiphon~(2.5\%).
Users identified reliability, speed, and ease of installation as the most important features of a circumvention tool.

% CORDON? Say how meek would be classified in it?

\section{Usage scenarios}

The default usage scenario has a single paid App Engine instance, publicly known and usable by anyone,
with software configured to use the public instance by default.
This way has the greatest usability because there is nothing to upload and nothing to configure.
The number of parties able to analyze users' traffic patterns is somewhat increased:
the path from user to bridge now includes Google and the app operators, not only the ISP and intermediate routers that were there before.
On the other hand, the bridge no longer gets to see users' IP addresses.
In effect, Google and the app become what Tor calls a ``guard node.''
Because Tor is encrypted and integrity-protected, neither Google nor the app operators
are able to read or alter users' communications, but being able to measure packet timings,
for example, is necessary for certain linking attacks.

Users are also free to upload their own personal copy of the App Engine code, as is done with GoAgent.
App Engine imposes bandwidth quotas on unpaid apps, but they are high enough to allow daily web browsing.
In this scenario, Google still has a privileged network position,
but the user's traffic is no longer visible to the operators of the public app instance.
% Outgoing HTTP requests include app id? As good as an IP address.

The code that runs on App Engine is very simple.
It just statelessly copies HTTP requests and responses.
Another usage scenario has the App Engine code ported to another language such as PHP,
so that it can be run in ordinary web hosting environments.
What you lose with a PHP app is Google's unblockability;
the censor may find and individually block the domains
This scenario is still interesting because there are so many places
where such an app can be run, with low cost and minimal setup.
Installing a PHP file on a web host environment is easier than setting up a Tor bridge or SOCKS proxy.
The URLs of PHP bridges could be distributed in a way like BridgeDB.

\section{Other third-party services}

A censor can block meek by blocking access to Google entirely.
To take such a step is extreme, because of its high collateral damage,
but it is not outside the realm of possibility.
% Cite when Google and Gmail were completely blocked temporarily.
We investigated how easily our system can be adapted to hard-to-block systems other than Google,
and found that CloudFlare, a content delivery network, in principle supports domain fronting.

CloudFlare provides the frontend of $X$ web sites, $Y$ of them supporting HTTPS~\cite{something}.
CloudFlare supports the domain fronting trick;
that is, it is possible that a request has one domain in the TLS layer
and another in the HTTP layer, and the CloudFlare server will transparently redirect it to proper place.
While we verified that domain fronting would work on CloudFlare,
we did not test deployment,
because when we asked we were told that our planned use would be against CloudFlare's terms of service.
CloudFlare hosts a number of HTTPS sites.
Choosing just one of them to be the front in TLS connections could cause
the innocent third-party domain to be censored even though it is not itself carrying any circumvention traffic.
To avoid this problem, the front can be simply a CloudFlare IP address,
with no SNI at all.
The censor then faces the choice of allowing circumvention traffic,
or else blocking a large number of popular unrelated web sites.

We were not able to make the system work with Amazon CloudFront nor Akamai.
% Dreamhost? Other HTTPS webhosts with PHP bridge?

%%%%%%%

% HTTPS or not on the App Engine--bridge link.
% HTTPS obscures session ids, equivalent to obscuring TCP connections in other transports.
% Increases latency a lot: \approx 100 ms increased to \approx 350 ms when I tried it in March 2014.

\bibliographystyle{plain}  
\bibliography{paper}

\end{document}
